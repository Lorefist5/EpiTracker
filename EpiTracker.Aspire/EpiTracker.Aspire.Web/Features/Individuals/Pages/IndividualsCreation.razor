@page "/individuals/create"
@using EpiTracker.Aspire.Web.Features.Individuals.Services
@using EpiTracker.Aspire.Web.Features.Individuals.components
@using EpiTracker.Domain.Features.Individuals.Dtos
@using Microsoft.AspNetCore.Components.Web
@using MudBlazor
@inject IIndividualApi IndividualApi
@inject ISnackbar Snackbar
@inject NavigationManager NavigationManager


<PageTitle>Create Individual</PageTitle>


<IndividualForm model="@model" ButtonText="Create Individual" OnSubmit="HandleCreateSubmit" />

@code {
    private CreateIndividualDto model = new CreateIndividualDto();

    private async Task HandleCreateSubmit(CreateIndividualDto individual)
    {
        var response = await IndividualApi.CreateIndividualAsync(individual);
        if (response.IsSuccessStatusCode)
        {
            Snackbar.Add("Individual Created Successfully!", Severity.Success);
            NavigationManager.NavigateTo("/individuals");
        }
        else
        {
            Snackbar.Add("Error creating individual.", Severity.Error);
        }
    }
}
